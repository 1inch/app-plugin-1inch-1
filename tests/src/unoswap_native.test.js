import 'core-js/stable';
import 'regenerator-runtime/runtime';
import { waitForAppScreen, zemuFixture } from './test.fixture';

test('Unoswap native token swap', async () => {
    await zemuFixture(async (sim, eth) => {
        // Native token to something (1.5 ETH to O3)
        // https://etherscan.io/tx/0xe2d17051ba2133a4dd7b89f3cc8f8ee5512e6b72e57e89e39a23565788f42a3c
        const tx = eth.signTransaction(
            "44'/60'/0'/0/0",
            'f90154820de785138eca4800830481d39411111112542d85b3ef69ae05771c2dccff4faa268814d1120d7b160000b8e42e95b6c8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014d1120d7b1600000000000000000000000000000000000000000000000000235f6a71a6c58aa4b60000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000200000000000000003b6d034074c99f3f5331676f6aec2756e1f39b4fc029a83e00000000000000003b6d03404b8852e4747b8a7d4caf0440e4e3397032a6723d25a0c5da83ad09c5c15e54ab526e87024366e7618517f26b6b67275ccbbba825328ca029e0994432accfb3f80d78a7d74d8fdbd1897024b951fb2e5f51bfc07bfa8af3',
        );
        await waitForAppScreen(sim);
        await sim.navigateAndCompareSnapshots('.', 'unoswap_native', [4, 0]);

        await expect(tx).resolves.toEqual({
            r: 'e9b47161721f5ebd3540c57c41e93406193f7c24df99f771ebd761e87aedc573',
            s: '697a28a0f0cce41de8639f71d6b7a521234761343aaed3b6808db518b9684619',
            v: '6e',
        });
    });
});
